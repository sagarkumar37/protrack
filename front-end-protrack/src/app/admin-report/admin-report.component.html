<br>
<div class="container">
    <div class="container">
        <div class="row">
            <div class="row">
                <!-- From Date selector input -->
                <div class="col">
                  <mat-form-field class="custom-mat-form-field" >
                    <mat-label>From Date</mat-label>
                    <input matInput type="date" class="form-control" placeholder="From Date" [(ngModel)]="startDate"/>
                  </mat-form-field>
                </div>
              
                <!-- To Date selector input -->
                <div class="col">
                  <mat-form-field class="custom-mat-form-field">
                    <mat-label>End Date</mat-label>
                    <input matInput type="date" class="form-control" placeholder="To Date" [(ngModel)]="endDate"/>
                  </mat-form-field>
                </div>
              
                <!-- Employee Dropdown -->
                <div class="col">
                  <mat-form-field class="custom-mat-form-field">
                    <mat-label>Employees</mat-label>
                    <mat-select [formControl]="selectedUsernames" multiple>
                      <mat-select-trigger>
                        {{selectedUsernames.value?.[0] || ''}}
                        <span *ngIf="(selectedUsernames.value?.length || 0) > 1" class="example-additional-selection">
                          (+{{(selectedUsernames.value?.length || 0) - 1}} {{selectedUsernames.value?.length === 2 ? 'other' : 'others'}})
                        </span>
                      </mat-select-trigger>
                      <mat-option #selectAllOption value="selectAll" (click)="toggleSelectAll()">Select All</mat-option>
                      <mat-option *ngFor="let username of usernames" [value]="username">{{username}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div class="col">
                <button class="btn btn-primary" (click)="fetchReport()">Fetch Report</button>
              </div>
        <br>
        <!-- ... (rest of your existing code) ... -->
      </div>
      

<br>
</div>




<div class="container"  *ngIf="viewReport">

    <mat-card class="fixed-height-card">
        <mat-card-header>
          <mat-card-title>Weekly Task Report</mat-card-title>
        </mat-card-header>
        <mat-card-content>

    <div class="table-responsive">
        <div class="col">
            <button class="btn btn-secondary" (click)="exportToExcel()">Export Report</button>
          </div>
          <br>
          <br>

          <div class="col">
        <table class="table table-striped table-hover table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>User Name</th>
                    <th>Task</th>
                    <th>Status</th>
                    <th>Challenge</th>
                    <th>AI Tool</th>
                    <th>Date</th>
                </tr> 
            </thead>
            <tbody>
                <tr *ngFor="let input of inputs; let i = index">
                    <td>{{input.username}}</td>
                    <td>{{input.task_description}}</td>
                    <td>{{input.status}}</td>
                    <td>{{input.challenge_description}}</td>
                    <td>{{input.ai_tool}}</td>
                    <td>{{input.year_week | dateFormat}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="col">
        <button class="btn btn-secondary" (click)="exportToExcel()">Export Report</button>
      </div>
        
    </div>

</mat-card-content>
<mat-card-actions>
</mat-card-actions>
</mat-card>
    <br>
 
    <br>

    <mat-card class="fixed-height-card">
        <mat-card-header>
          <mat-card-title>Weekly Ratings</mat-card-title>
        </mat-card-header>
        <mat-card-content>
    <div class="table-responsive">
        <div class="col">
            <button class="btn btn-secondary" (click)="exportToExcel2()">Export Report</button>
          </div>
          <br>
          <br>
        
        <table class="table table-striped table-hover table-bordered">
            <thead class="thead-light">
                <tr>
                    <th>User Name</th>
                    <th>Busyness %</th>
                    <th>Satisfaction %</th>
                    <th>Learning %</th>
                    <th>Core %</th>
                    <th>AI Productivity %</th>
                    <th>Skill Acquired</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let rating of ratings; let j= index">
                    <td>{{rating.username}}</td>
                    <td>{{rating.busyness}}</td>
                    <td>{{rating.satisfaction}}</td>
                    <td>{{rating.learning}}</td>
                    <td>{{rating.core}}</td>
                    <td>{{rating.ai_productivity}}</td>
                    <td>{{rating.skill_acquired}}</td>
                    <td>{{rating.year_week|dateFormat}}</td>
                </tr>
            </tbody>
        </table>
        <div class="col">
            <button class="btn btn-secondary" (click)="exportToExcel2()">Export Report</button>
          </div>
    </div>
</mat-card-content>
<mat-card-actions>
</mat-card-actions>
</mat-card>
</div>


<!-- <div class="container" >
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Status</th>
                    <th>Challenge</th>
                    <th>Al Tool</th>
                </tr> 
            </thead>
            <tbody>
                <tr *ngFor="let input of inputs;let i = index">
                    <td>{{input.task}}</td>
                    <td>{{input.status}}</td>
                    <td>{{input.challenge}}</td>
                    <td>{{input.aiTool}}</td>
                    
        
                </tr>
            </tbody>
        </table>
        </div>
        <br>
        <br>
        <div>Ratings</div>
        <br>
        <div class="table-responsive">
            <table class = "table">
                <thead>
                    <tr>
                        <th>Busyness %</th>
                        <th>Satisfaction %</th>
                        <th>Learning %</th>
                        <th>Core %</th>
                        <th>AI Productivity %</th>
                        <th>Skill Acquired</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ratings.busyness}}</td>
                        <td>{{ratings.satisfaction}}</td>
                        <td>{{ratings.learning}}</td>
                        <td>{{ratings.core}}</td>
                        <td>{{ratings.aiProductivity}}</td>
                        <td>{{ratings.skillAcquired}}</td>
                        
                    </tr>
                </tbody>
            </table>
        </div>

</div> -->





